<svg xmlns="http://www.w3.org/2000/svg" width="1000" height="400" viewBox="0 0 1000 400">
  <defs>
    <style>
      /* Dark Mode Colors derived from system_architecture_diagram_dark.svg */
      .box { fill: #1e293b; stroke: #a78bfa; stroke-width: 2; rx: 8; ry: 8; }
      .box-compositor { fill: #2e1065; stroke: #d946ef; stroke-width: 3; rx: 12; ry: 12; }
      .optical-space { fill: none; stroke: #4ade80; stroke-width: 2; stroke-dasharray: 8 4; rx: 16; ry: 16; }
      .line { stroke: #cbd5e1; stroke-width: 2; fill: none; marker-end: url(#arrow); }
      text { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; }
      .text { font-size: 14px; text-anchor: middle; fill: #f1f5f9; }
      .text-sub { font-size: 11px; fill: #94a3b8; }
      .text-title { font-size: 24px; font-weight: 700; fill: #c084fc; text-anchor: middle; }
      .text-label { font-size: 12px; font-weight: 600; fill: #86efac; text-anchor: middle; }
    </style>
    <marker id="arrow" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L0,6 L9,3 z" fill="#cbd5e1" />
    </marker>
  </defs>

  <!-- Title -->
  <text x="500" y="40" class="text-title">THE WATCHOUT PIPELINE</text>

  <!-- Optical Space Container -->
  <!-- Enclosing Input CS Convs and Compositor -->
  <rect x="300" y="80" width="400" height="260" class="optical-space" />
  <text x="500" y="360" class="text-label" style="font-size: 16px;">Optical Space</text>

  <!-- Row 1: Input X -->
  <g transform="translate(20, 100)">
    <text x="60" y="-10" class="text-sub" style="fill:#fbbf24">8-bit Rec. 709 (SDR)</text>
    <rect width="120" height="50" class="box" />
    <text x="60" y="30" class="text" style="font-weight:600">Input X</text>
  </g>
  <path d="M140,125 L160,125" class="line" />

  <g transform="translate(160, 100)">
    <rect width="80" height="50" class="box" />
    <text x="40" y="30" class="text">EOTF</text>
  </g>
  <path d="M240,125 L260,125" class="line" />

  <g transform="translate(260, 100)"> <!-- Inside Optical Box -->
    <rect width="80" height="50" class="box" />
    <text x="40" y="30" class="text">CS Conv.</text>
  </g>
  <path d="M340,125 L450,180" class="line" /> <!-- To Compositor -->

  <!-- Row 2: Input Y -->
  <g transform="translate(20, 180)">
    <text x="60" y="-10" class="text-sub" style="fill:#fbbf24">16-bit Rec. 2100 PQ (HDR)</text>
    <rect width="120" height="50" class="box" />
    <text x="60" y="30" class="text" style="font-weight:600">Input Y</text>
  </g>
  <path d="M140,205 L160,205" class="line" />

  <g transform="translate(160, 180)">
    <rect width="80" height="50" class="box" />
    <text x="40" y="30" class="text">EOTF</text>
  </g>
  <path d="M240,205 L260,205" class="line" />

  <g transform="translate(260, 180)">
    <rect width="80" height="50" class="box" />
    <text x="40" y="30" class="text">CS Conv.</text>
  </g>
  <path d="M340,205 L450,205" class="line" />

  <!-- Row 3: Input Z -->
  <g transform="translate(20, 260)">
    <text x="60" y="-10" class="text-sub" style="fill:#fbbf24">10-bit Rec. 2020 (SDR)</text>
    <rect width="120" height="50" class="box" />
    <text x="60" y="30" class="text" style="font-weight:600">Input Z</text>
  </g>
  <path d="M140,285 L160,285" class="line" />

  <g transform="translate(160, 260)">
    <rect width="80" height="50" class="box" />
    <text x="40" y="30" class="text">EOTF</text>
  </g>
  <path d="M240,285 L260,285" class="line" />

  <g transform="translate(260, 260)">
    <rect width="80" height="50" class="box" />
    <text x="40" y="30" class="text">CS Conv.</text>
  </g>
  <path d="M340,285 L450,230" class="line" />

  <!-- Compositor (Center) -->
  <g transform="translate(450, 155)">
    <rect width="180" height="100" class="box-compositor" />
    <text x="90" y="45" class="text" style="font-weight:700; fill:#e879f9">COMPOSITOR</text>
    <text x="90" y="65" class="text">16-bit linear</text>
    <text x="90" y="85" class="text">Rec. 2020</text>
  </g>
  <path d="M630,205 L660,205" class="line" />

  <!-- Output Stage -->
  <g transform="translate(660, 180)">
    <rect width="80" height="50" class="box" />
    <text x="40" y="30" class="text">CS Conv.</text>
  </g>
  <path d="M740,205 L770,205" class="line" />

  <g transform="translate(770, 180)">
    <rect width="60" height="50" class="box" />
    <text x="30" y="30" class="text">OETF</text>
  </g>
  <path d="M830,205 L860,205" class="line" />

  <g transform="translate(860, 180)">
    <text x="60" y="-10" class="text-sub" style="fill:#fbbf24">12-bit Rec. 2100 PQ (HDR)</text>
    <rect width="120" height="50" class="box" style="stroke:#d946ef" />
    <text x="60" y="30" class="text" style="font-weight:600">Output</text>
  </g>
</svg>
